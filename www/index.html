<!doctype html>
<html ng-app lang="en">
<head>
	<title>Zboota</title>
        <script src="js/vendor/jquery-2.1.1.min.js"></script>
        <script src="js/vendor/angular-1.2.28.min.js"></script>
        <!--<script src="js/vendor/angular-1.2.28.js"></script>-->
        <script src="js/vendor/moment-2.9.0.min.js"></script>
        <script src="js/vendor/bootstrap-3.3.4.min.js"></script>
        <script src="js/common.js"></script>
        <script src="js/Controller1.js"></script>
        <script src="js/Controller2.js"></script>
	<!--<link rel="stylesheet" type="text/css" href="css/vendor/bootstrap.min.css" />-->
	<link rel="stylesheet" type="text/css" href="css/vendor/bootstrap-3.3.4.min.css" />
	<link rel="stylesheet" type="text/css" href="css/vendor/bootstrap-responsive.min.css" />
	<link rel="stylesheet" type="text/css" href="css/index.css" />
</head>
<body>
<div ng-controller="Controller1" class="container">
	<div ng-controller="Controller2">
		<div class="row">
			<div class="text-muted pull-left"><img src="img/logo-57.png" /><!-- Zboota--></div>
			<div class="btn-group pull-right" role="group"><!-- ng-show="serverAvailable">-->
				<button ng-click="logout();" ng-show="loginStatus=='Logged in'" class="btn btn-small">Log out</button>
				<button ng-click="showLogin();" ng-disabled="loginStatus!='None'||getStatus!='None'" ng-show="loginStatus!='Logged in'" class="btn btn-small">Existing user</button>
				<button ng-click="showNew();" ng-disabled="newUStatus!='None'||getStatus!='None'" ng-show="loginStatus!='Logged in'" class="btn btn-small">New user</button>
			</div>
			<div ng-show="loginStatus=='Logged in'" class="pull-right">{{loginU.email}} &nbsp;</div>
			<div class="pull-left">
				<span ng-show="getStatus=='Requesting'||loginStatus=='Logging in'" class="blinking">&#x25BC</span>
				<span ng-show="updateStatus=='Updating'" class="blinking">&#x25B2</span>
			</div>
		</div>
		<div class="modal" id="loginModal" aria-hidden="true" hidden data-backdrop="static">

			<div class="modal-header">
       				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				Enter your email <span ng-show="loginType!='New'"> and password</span>
			</div>
			<div class="modal-body">
				<input ng-model="loginU.email" type="text" size=5 placeholder="Email" ng-show="loginStatus!='Logged in'" ng-disabled="loginStatus=='Logged in'"/> <br>
				<input ng-model="loginU.pass" type="password" size=5 placeholder="Password" ng-show="loginStatus!='Logged in'&&loginType=='Log in'" /> <br>
			</div>
			<div class="modal-footer pull-left" align="left">
				<button ng-click="login();" ng-show="loginType=='Log in'" ng-disabled="loginStatus!='None'||getStatus!='None'||!loginU.email||!loginU.pass" class="btn btn-primary">Log in</button> &nbsp;
				<button ng-click="forgotPassword();" ng-show="loginType=='Log in'" ng-disabled="loginStatus!='None'||getStatus!='None'||!loginU.email||forgotPasswordStatus" class="btn btn-warning">Forgot password</button> &nbsp;
				<button ng-click="newU();" ng-show="loginType=='New'" ng-disabled="newUStatus!='None'||!loginU.email" class="btn btn-primary">Create</button> &nbsp;
			</div>
		</div>
	</div>



	<table border=0 id="mytable" class="table">
	<tr>
		<th></th>
		<th>Tickets</th>
		<th>
			<!--<button ng-click="clear()" class="btn btn-danger">Clear</button>-->
			<button ng-click="get();" ng-disabled="(getStatus!='None' || !serverAvailable || noData())" class="btn btn-success btn-small"><span class="glyphicon glyphicon-refresh"></span></button>
		</th>
	</tr>
	<tbody ng-repeat="rd in data">
		<tr class="{{getCarRowClass(rd.a,rd.n)}}">
			<td rowspan={{rd.dm?2:1}}><!-- style="white-space: nowrap">-->
				<span>{{rd.l}}</span>
				<br>
				<span class="text-muted">{{rd.a}} &nbsp; {{rd.n}}</span>
				<div ng-if="rd.hp || rd.y || rd.t" class="text-muted">
				{{rd.hp}} HP <br> {{rd.y}} <br> {{rd.t}}
				</div>
			</td>
			<td>
				<div ng-if="rd.isf!='None' && rd.isf">
					<a href="http://www.isf.gov.lb/en/speedtickets">ISF</a>:<br>
					{{rd.isf}}
				</div>
				<div ng-if="rd.pml!='None' && rd.pml">
					<a href="http://www.parkmeterlebanon.com/default/STATMENT_OF_ACCOUNT.aspx">PML</a>:<br>
					{{rd.pml}}
				</div>
				<div ng-if="rd.isf=='None' && rd.pml=='None'">
					None
				</div>
				<div ng-if="!rd.isf || !rd.pml" class="blinking">&#x25BC</div>
			</td>
			<td rowspan={{rd.dm?2:1}}><button ng-click="del(rd.a,rd.n)" class="btn btn-danger"><span class="glyphicon glyphicon-minus"></span></button></td>
		</tr>
		<tr ng-if="rd.dm" class="{{getCarRowClass(rd.a,rd.n)}}"><td><a href="http://www.dawlati.gov.lb/en/mecanique">Mechanique</a>: {{rd.dm}}</td></tr>
	</tbody>
	<tr ng-show="noData()">
		<td colspan=6>None</td>
	</tr>
	<tr><td colspan=6><button ng-click="showAdd();" class="btn btn-primary btn-lg btn-block">Add</button></td></tr>
	</table>

	<div class="row">
		<div class="pull-right text-muted text-right" ng-class="dataDateVsToday()">
			Today: {{momentFormat2(tnow)}}<br>
			<span ng-show="dataTs!=null" >Data: {{momentFormat2(dataTs)}}</span>
		</div>
	</div>

	<div id="addModal" class="modal" aria-hidden="true" hidden data-backdrop="static">
	<div class="modal-dialog">
      <div class="modal-content">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			Enter car details
		</div>
		<div class="modal-body">
			Letter: &nbsp; <select ng-model="addC.a" class="dropdown form-control"><option ng-repeat="a in areas" ng-value="a">{{a}}</option></select> <br>
			<input type="text" ng-model="addC.n" placeholder="Number" size=10 class="form-control" /> <br>
			<input type="text" ng-model="addC.l" placeholder="Label" size=10 class="form-control" /> <br>
			Optional (for mechanique schedule): <br>
			Horse power: &nbsp; <select ng-model="addC.hp" class="dropdown form-control"><option ng-repeat="a in horsepowers" ng-value="a">{{a}}</option></select> <br>
			Year of model: &nbsp; <select ng-model="addC.y" class="dropdown form-control"><option ng-repeat="a in years" ng-value="a">{{a}}</option></select> <br>
			Type: &nbsp; <select ng-model="addC.t" class="dropdown form-control"><option ng-repeat="a in cartypes" ng-value="a">{{a}}</option></select> <br>
		</div>
		<div class="modal-footer pull-left">
			<button ng-click="add();" class="btn btn-primary" ng-disabled="!addC.a||!addC.n||!addC.l||!((!addC.y&&!addC.hp&&!addC.t)||(addC.y&&addC.hp&&addC.t))">Add</button> &nbsp;
			<button ng-click="hideAdd(); addReset()" class="btn">Cancel</button> &nbsp;
		</div>
		</div>
		</div>

	</div>

</div><!-- end Controller1 -->

</body>
</html>
